<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Class Rep Election — Law Dept</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-900 to-purple-700 text-white antialiased">
  <header class="py-6">
    <div class="max-w-5xl mx-auto px-6 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center">⚖️</div>
        <div>
          <h1 class="text-2xl font-bold">Law Dept — Class Representative Election</h1>
          <p class="text-sm text-white/80">Transparent • Secure • One person — one vote</p>
        </div>
      </div>
      <nav class="space-x-4">
        <a href="vote.html" class="px-3 py-2 bg-amber-400 text-indigo-900 rounded">Vote</a>
        <a href="results.html" class="px-3 py-2 border rounded border-white/20">Results</a>
        <a href="admin.html" class="px-3 py-2 border rounded border-white/20">Admin</a>
      </nav>
    </div>
  </header>

  <main class="max-w-4xl mx-auto px-6 py-12 text-center">
    <h2 class="text-3xl font-extrabold mb-4">Make your voice count</h2>
    <p class="text-white/80 mb-6">Sign in with Google to vote. Results will be live and auditable.</p>

    <div id="meta" class="bg-white/10 p-6 rounded-xl inline-block text-left text-sm">
      Loading election status...
    </div>
  </main>

  <footer class="text-center py-8 text-white/60">
    © <span id="year"></span> Law Department
  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
    import { firebaseConfig } from "./js/firebaseConfig.js";

    document.getElementById('year').textContent = new Date().getFullYear();
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    (async function loadMeta(){
      try {
        const ref = doc(db,'election','meta');
        const snap = await getDoc(ref);
        const el = document.getElementById('meta');
        if (!snap.exists()) {
          el.innerHTML = `<b>No election configured.</b> Admin: create election in admin panel.`;
          return;
        }
        const data = snap.data();
        el.innerHTML = `<div class="font-semibold">${data.title || 'Class Rep Election'}</div>
                        <div>Status: <span class="font-medium">${data.status||'ready'}</span></div>
                        <div>Start: ${data.startAt || 'N/A'}</div>
                        <div>End: ${data.endAt || 'N/A'}</div>`;
      } catch(e){
        console.error(e);
        document.getElementById('meta').innerText = 'Error loading election meta.';
      }
    })();
  </script>
</body>
</html>
